
Open File

***** Deduce EXE Type *****

READ & LOAD 'EXE_HEADER_OE_32'

BRANCH WORD@0x00 = "MZ" || "ZM"
IF TRUE: GOTO 'EXE_OE'
IF FALSE: GOTO 'EXIT_FAILURE'

:EXE_OE
BRANCH: EXE_HEADER_OE_32->e_lfarlc >= 64 bytes (0x40)
IF TRUE: GOTO 'EXE_NE'
IF FALSE: GOTO 'EXE_OE'

:EXE_NE
READ & LOAD 'EXE_HEADER_NE'
SEEK EXE_HEADER_NE->e_lfanew

READ & LOAD 'EXE_HEADER_EE'



BRANCH: EXE_HEADER->e_lfarlc <= 32 bytes
IF TRUE: GOTO 'OE'
IF FALSE: GOTO 'EE'

:OE

:EE

BRANCH: EXE_HEADER->e_lfarlc <= 64 bytes
IF TRUE: GOTO 'NE'
IF FALSE: GOTO 'PE'

:NE

READ EXE_HEADER_NE

:PE

BRANCH: EXE_HEADER->e_lfarlc > 64 bytes
IF TRUE: GOTO 'PE64'
IF FALSE: GOTO 'EXIT_FAILURE'

:PE64



...

GOTO 'EXIT_SUCCESS'

:EXIT_SUCCESS

: EXIT_FAILURE
